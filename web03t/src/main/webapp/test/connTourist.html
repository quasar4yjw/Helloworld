<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>connect history</title>
    <meta name="description" content="Blueprint: View Mode Switch" />
    <meta name="keywords" content="view mode, switch, css, style, grid, list, template" />
    <meta name="author" content="Codrops" />
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../css/defaultConn.css" />
    <link rel="stylesheet" type="text/css" href="../css/component.css" />
    <script src="../js/modernizr.custom.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel='stylesheet' href='../css/bootstrap.min.css'>
    <link rel='stylesheet' href='../css/bootstrap-theme.min.css'>
    <link rel='stylesheet' href='../css/common.css'>
    
    <link rel='stylesheet' href='/web03t/css/login-popup.css'>
    
    <style>
  .myButton {
    color: #fff;
  background: #47a3da;/* #fc8387; */
  padding: 10px 20px;
  border-radius: 2px;
  margin: 20px 0 0;
  display: inline-block;
  transition: background 0.2s;
  }
  
.myButton:hover {
  color: #fff;
  background: #ff5a5f;
}
.myButton:before {
  margin-right: 5px;
}
.test-hover:hover {
  background: white;
}
 .cbp-vm-date {
  display: inline-block;
  margin-left: 5px;
 }
 .conn-menubar {
  padding-bottom: 10px;
  border-bottom: 3px solid #bdbdbd;
 } 
 
  .menu-date {
  display: inline-block;
  margin: 0px 175px 0px 10px;
}
  .menu-status {
  display: inline-block;
  margin-right: 105px;
}
 
  .menu-price {
  display: inline-block;
  margin-right: 130px;
}
  .menu-item {
  display: inline-block;
}
   h1 {
display: block;
color: #ff5a5f;
font-weight: 700;
font-size: 1.85em;
padding: 50px 0px 20px 20%;
}
a.myButton {
text-decoration: none;
}
a.cbp-vm-add {
text-decoration: none;
}
div#page-selection {
padding-left: 40%;
}
    </style>
  </head>
  <body>
    <div class="container">
     <div class="header"></div>
     <h1>연결 정보</h1>


      <div class="main">
        <div id="cbp-vm" class="cbp-vm-switcher cbp-vm-view-list">
          <div class="cbp-vm-options">
            
       
          <a href="#" class="myButton myButtonTotal">전체</a>
          <a href="#" class="myButton myButtonReq">예약요청</a>
          <a href="#" class="myButton myButtonSucc">예약완료</a>
          <a href="#" class="myButton myButtonCancel">예약취소</a>
          
          </div>
          
          <div class="conn-menubar">
          <div class="menu-date">
          여행 날짜
          </div>
          <div class="menu-status">
          상태
          </div>
          <div class="menu-price">
          가격
          </div>
          <div class="menu-item">
          관광 상품
          </div>
          
          </div>
         
          <!-- <ul>
          
            <li class="test-hover" onclick="location.href='#'";>
            
              <div class="cbp-vm-date">2014.01.22</div>
              <a class="cbp-vm-image" href="#"><img src="../images/conn1.jpg"></a>
              <h3 class="cbp-vm-title" id="reserv-request">예약요청</h3>
              <div class="cbp-vm-price">100,000 원</div>
              <div class="cbp-vm-details">
                동산위에 올라서서 파란 하늘 바라 보며
              </div>
              
              <a class="cbp-vm-icon cbp-vm-add" href="#">취소</a>
            </li>
            
            <li class="test-hover">
              <div class="cbp-vm-date">2014.01.22</div>
              <a class="cbp-vm-image" href="#"><img src="../images/conn2.jpg"></a>
              <h3 class="cbp-vm-title" id="reserv-complete">예약완료</h3>
              <div class="cbp-vm-price">20,000 원</div>
              <div class="cbp-vm-details">
                저랑 치즈케이크 드실래요?
              </div>
              
            </li>
            <li class="test-hover">
              <div class="cbp-vm-date">2014.01.22</div>
              <a class="cbp-vm-image" href="#"><img src="../images/conn3.jpg"></a>
              <h3 class="cbp-vm-title" id="reserv-cancel">예약취소</h3>
              <div class="cbp-vm-price">90,000 원</div>
              <div class="cbp-vm-details">
                Kohlrabi bok choy broccoli rabe welsh onion spring onion tatsoi ricebean kombu chard.
              </div>
              
            </li>
            <li class="test-hover">
              <div class="cbp-vm-date">2014.01.22</div>
              <a class="cbp-vm-image" href="#"><img src="../images/conn4.jpg"></a>
              <h3 class="cbp-vm-title" id="reserv-cancel">예약취소</h3>
              <div class="cbp-vm-price">120,000 원</div>
              <div class="cbp-vm-details">
                Melon sierra leone bologi carrot peanut salsify celery onion jícama summer purslane.
              </div>
              
            </li>
            <li class="test-hover">
              <div class="cbp-vm-date">2014.01.22</div>
              <a class="cbp-vm-image" href="#"><img src="../images/conn5.jpg"></a>
              <h3 class="cbp-vm-title" id="reserv-complete">예약완료</h3>
              <div class="cbp-vm-price">150,000 원</div>
              <div class="cbp-vm-details">
                Celery carrot napa cabbage wakame zucchini celery chard beetroot jícama sierra leone.
              </div>
            </li>
            <li class="test-hover">
              <div class="cbp-vm-date">2014.01.22</div>
              <a class="cbp-vm-image" href="#"><img src="../images/conn6.jpg"></a>
              <h3 class="cbp-vm-title" id="reserv-complete">예약완료</h3>
              <div class="cbp-vm-price">200,000 원</div>
              <div class="cbp-vm-details">
                Catsear cabbage tomato parsnip cucumber pea brussels sprout spring onion shallot swiss .
              </div>
            </li>
            <li class="test-hover">
              <div class="cbp-vm-date">2014.01.22</div>
              <a class="cbp-vm-image" href="#"><img src="../images/conn7.jpg"></a>
              <h3 class="cbp-vm-title" id="reserv-request">예약요청</h3>
              <div class="cbp-vm-price">180,000 원</div>
              <div class="cbp-vm-details">
                Mung bean taro chicory spinach komatsuna fennel.
              </div>
              <a class="cbp-vm-icon cbp-vm-add" href="#">취소</a>
            </li>
            
          </ul>
           -->
           
        <ul id='connectUl'>            
       
           </ul>
          
        </div>
          <div id="page-selection"></div>
      </div><!-- /main -->
      
    </div><!-- /container -->
      <div class="footer"></div>
      <div id="somedialog" class="dialog"></div>
    <script src="../js/classie.js"></script>
    <script src="../js/cbpViewModeSwitch.js"></script>
    
    
    <script type="text/javascript" src='../js/handlebars-v2.0.0.js'></script>
    <!-- <script type="text/javascript" src='../js/require.js'></script> -->
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js" type="text/javascript"></script>
  <script type="text/javascript" src="http://rawgit.com/botmonster/jquery-bootpag/master/lib/jquery.bootpag.min.js"></script>
    <script type="text/javascript">
  $('.dialog').load('loginDialog.html');
  $('.header').load('header.html');
  $('.footer').load('footer.html');
  var selected = "all";
  
  loadItemList(1);
  function setPageNo(currPageNo, maxPageNo) {
      window.currPageNo = currPageNo;
      window.maxPageNo = maxPageNo;
      
    
      
      if (currPageNo <= 5)
        $('#prevBtn').css('display', 'none');
      else
        $('#prevBtn').css('display', '');
      if (currPageNo >= maxPageNo)
        $('#nextBtn').css('display', 'none');
      else
        $('#nextBtn').css('display', '');
      
      $('#page-selection').bootpag({
        total: maxPageNo,
        page: currPageNo,
        maxVisible: 5 
      }).on('page', function(event, num){
        loadItemList(num);   
      });
    }
      
    function loadItemList(pageNo) {
      if (pageNo <= 0) pageNo = currPageNo;
      
      $.getJSON('../connect/status.do?pageNo=' + pageNo + "&selected=" + selected, 
        function(data){
          console.log(data);
          setPageNo(data.currPageNo, data.maxPageNo);
          var connects = data.connects; 
          
          $.get('templates/connect-Tlist.html', function(source){
            var template = Handlebars.compile(source);
            $('#connectUl').html( template(data) );
            $(".예약요청").css('color','#669999');
            $(".예약완료").css('color','#3399CC');
            $(".예약취소").css('color','#C24747');
          });
        });
    }
 
</script>
    
    
    
    
    
    <script>
    
    $( '.myButtonTotal' ).click(function() {
      $( '.myButtonTotal' ).css("background-color","#ff5a5f");
      $( '.myButtonReq' ).css("background-color","#47a3da");
      $( '.myButtonSucc' ).css("background-color","#47a3da");
      $( '.myButtonCancel' ).css("background-color","#47a3da");
      selected = "all"
      loadItemList(1);
    });
    
    $( '.myButtonReq' ).click(function() {
          $( '.myButtonTotal' ).css("background-color","#47a3da");
          $( '.myButtonReq' ).css("background-color","#ff5a5f");
          $( '.myButtonSucc' ).css("background-color","#47a3da");
          $( '.myButtonCancel' ).css("background-color","#47a3da");
          selected = "req";
          loadItemList(1);
          
        });
    
    $( '.myButtonSucc' ).click(function() {
          $( '.myButtonTotal' ).css("background-color","#47a3da");
          $( '.myButtonReq' ).css("background-color","#47a3da");
          $( '.myButtonSucc' ).css("background-color","#ff5a5f");
          $( '.myButtonCancel' ).css("background-color","#47a3da");
          selected = "succ";
          loadItemList(1);
          
        });
    
    $( '.myButtonCancel' ).click(function() {
          $( '.myButtonTotal' ).css("background-color","#47a3da");
          $( '.myButtonReq' ).css("background-color","#47a3da");
          $( '.myButtonSucc' ).css("background-color","#47a3da");
          $( '.myButtonCancel' ).css("background-color","#ff5a5f");
          selected = "cancel";
          loadItemList(1);
          
        });
 
   
    Handlebars.registerHelper('stat', function(connectStatus) {
    	if (connectStatus == '예약요청')
        return connectStatus;
    else if(connectStatus == '예약완료')  return connectStatus;
    else if(connectStatus == '예약취소')  return connectStatus;
      });

    
    Handlebars.registerHelper("btnCancel", function (title, connectStatus, no) {
    	if (connectStatus == '예약요청'){
        var btnCancel = $('<a class="cbp-vm-add btnCancel" href="#"></a>') .text(title).attr('onclick', 'updateConnect('+ no +')').attr('cno', no);
        return $('<div></div>').append(btnCancel).html();

    	} else {
    		console.log(connectStatus); 
    		console.log(title);
    	}
    });
    
    function updateConnect(no) {
    	
         $.getJSON('../connect/update.do' 
                , {
                  connectNo:no
                  }
                , function(result){
                      if (result.status == "success") {
                    	  loadItemList(1);
                        alert("변경 성공!");
                      } else {
                        alert("변경 실패!");
                      }
                    }  
                
                
                ); 
                };
          

    

    </script>
    


 
  </body>
</html>